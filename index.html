<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Compressed Air Assessment</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>
    <style>
      * {
        box-sizing: border-box;
      }
      body {
        margin: 0;
        padding: 20px;
        font-family: Arial, sans-serif;
        background: #f5f5f5;
      }
      .container {
        max-width: 900px;
        margin: auto;
        background: #fff;
        padding: 25px;
        padding-top: 0px;
        border-radius: 5px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      }
      h1 {
        text-align: center;
        margin-bottom: 20px;
      }
      h2 {
        margin-top: 30px;
        font-size: 1.5em;
        padding-bottom: 5px;
        color: #3c3a3a;
      }

      .email_template {
        color: #a7a7a7;
        font-size: 15px;
      }

      .form-group {
        margin-bottom: 15px;
        border: 2.3px solid #efecec;
        padding: 1.5rem;
        border-radius: 5px;
        outline: none;
      }
      .form-group label {
        display: block;
        font-weight: bold;
        font-size: 15px;
        margin-bottom: 18px;
        color: #3c3a3a;
      }
      .extra {
        margin-bottom: 0;
      }
      .form-group small {
        font-weight: normal;
        color: #b8b6b6;
        display: block;
        margin-top: 15px;
        font-size: 15px;
      }
      .cfm {
        display: flex;
        flex-direction: column;
      }
      .required {
        color: #f74141;
        font-size: 28px;
      }
      input[type="text"],
      input[type="number"],
      input[type="date"],
      textarea {
        width: 100%;
        padding: 15px;
        border: 2px solid #efecec;
        border-radius: 4px;
        font-size: 15px;
        font-family: sans-serif;
        color: #b8b6b6;
      }
      input[type="date"] {
        background-color: #f2faff;
        border: none;
      }
      #sign_off {
        padding: 2.5rem;
        text-align: center;
      }
      textarea {
        min-height: 110px;
        resize: vertical;
      }

      .checkbox-group {
        display: flex;
        flex-direction: column;
      }

      .checkbox-group label {
        display: flex;
        align-items: center;
        gap: 2px;
        margin-bottom: 0;
        font-weight: 500;
      }

      .radio-group {
        display: flex;
        flex-direction: column;
        gap: 6px;
      }

      .radio-group label {
        display: flex;
        align-items: center;
        gap: 8px;
        font-weight: 500;
        margin-bottom: 0;
        line-height: 1.2;
      }

      .radio-group input[type="radio"] {
        vertical-align: middle;
      }

      input[type="checkbox"] {
        margin-right: 5px;
        height: 16px;
        width: 16px;
        cursor: pointer;
        position: relative;
        -webkit-appearance: none;
        -moz-appearance: none;
        appearance: none;
        border: 2.3px solid #eae8e8;
        border-radius: 4px;
        outline: none;
      }

      input[type="checkbox"]:checked {
        -webkit-appearance: checkbox;
      }

      .button-group {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr;
        gap: 0.5rem;
        margin-top: 1.3rem;
      }

      .button-group button {
        padding: 0.8rem;
        border: 1.6px solid #eae8e8;
        border-radius: 4px;
        background-color: #fff;
        color: #0798f0;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
      }

      .button-group button.active {
        background-color: #d7e9fc;
        border: 2px solid #aeaefe;
      }

      .image-container {
        margin: 10px 0;
        text-align: center;
      }
      .image-container img {
        max-width: 100%;
        border: 1px solid #ccc;
        border-radius: 4px;
      }
      .image-preview img {
        max-width: 100%;
        margin-top: 0.5em;
        border: 1px solid #ccc;
        border-radius: 4px;
      }

      input[type="file"] {
        display: none;
      }

      button[type="submit"] {
        background-color: #007bff;
        color: #fff;
        padding: 10px 20px;
        font-size: 16px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
      }
      button[type="submit"]:hover {
        background-color: #0056b3;
      }

      .selection-tag-container {
        display: none;
        width: 19rem;
        height: 3rem;
        padding: 0.3rem 0.6rem;
        position: absolute;
        top: 28%;
        right: 1.75em;
        transform: translateY(-50%);
        pointer-events: none;
        z-index: 10;
        border: 1.6px solid #eae8e8;
        border-radius: 4px;
        background-color: #fff;
        align-items: center;
        justify-content: space-between;
        gap: 8px;
      }

      .selection-tag-container.visible {
        display: flex; /* Show when this class is added */
      }

      /* Search icon */
      .search-icon {
        font-size: 2rem;
        color: #888;
        pointer-events: auto;
        margin-bottom: 4px;
      }

      /* Pill tag */
      .selection-tag {
        display: inline-flex;
        align-items: center;
        background: #f5fafd;
        padding: 4px 10px;
        font-size: 1.1em;
        border-radius: 3px;
        pointer-events: auto;
        white-space: nowrap;
        gap: 6px;
      }

      /* Inner × in the pill */
      .clear-btn.inner {
        font-size: 16px;
        color: #b8b6b6;
        cursor: pointer;
        pointer-events: auto;
        user-select: none;
      }

      /* Outer × on the right side of container */
      .clear-btn.outer {
        font-size: 20px;
        color: #b8b6b6;
        cursor: pointer;
        pointer-events: auto;
        margin-left: auto;
        user-select: none;
      }

      .pipe-symbol {
        font-size: 1.4rem;
        color: #ccc;
        margin: 0 8px;
        pointer-events: none;
        user-select: none;
      }

      .fake-dropdown {
        font-size: 1.8rem;
        color: #007bff; /* Bootstrap blue or adjust as needed */
        pointer-events: none;
        user-select: none;
        font-weight: bold;
        margin-bottom: 18px;
      }

      .custom-upload-box {
        height: 8rem;
        align-content: center;
        padding: 1.5rem;
        text-align: center;
        cursor: pointer;
        color: #777;
        font-size: 16px;
        font-style: italic;
        transition: all 0.3s ease;
        background-color: #f5fafd;
      }

      input[type="file"] {
        display: none;
      }

      .image-preview {
        display: grid;
        grid-template-columns: repeat(1, 1fr); /* Change to 1 per row for larger previews */
        gap: 25px;
        margin-top: 10px;
      }

      .image-preview img {
        width: 100%;
        height: 400px; /* increased from 200px */
        object-fit: contain;
        border: 1px solid #ccc;
        border-radius: 5px;
      }

      .top_hr{
        color: black;
        height: 30px;
        background-color: black;
        margin-left: -25px;
        margin-right: -25px;
      }

      .sign_canvas {
        height: 110px;
        width: 100%;
        border: 2px solid #efecec;
        color: #b8b6b6;
        border-radius: 4px;
      }

      .hidden {
        display: none;
      }
      
      /* Tabs styling */
      .tabs {
        overflow: hidden;
        border: 1px solid #ccc;
        background-color: #f1f1f1;
        border-radius: 5px 5px 0 0;
      }
      
      .tabs button {
        background-color: inherit;
        float: left;
        border: none;
        outline: none;
        cursor: pointer;
        padding: 14px 16px;
        transition: 0.3s;
        font-size: 17px;
      }
      
      .tabs button:hover {
        background-color: #ddd;
      }
      
      .tabs button.active {
        background-color: #007bff;
        color: white;
      }
      
      .tabcontent {
        display: none;
        padding: 6px 12px;
        border: 1px solid #ccc;
        border-top: none;
      }
      
      .tab-navigation {
        margin-top: 20px;
        text-align: right;
      }
      
      .tab-navigation button {
        background-color: #007bff;
        color: white;
        padding: 10px 20px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 16px;
      }
      
      .tab-navigation button:hover {
        background-color: #0056b3;
      }

      .submit-button, .download-button {
        padding: 12px 24px;
        margin: 0 10px;
        font-size: 16px;
        font-weight: 600;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        transition: background-color 0.3s ease;
      }

      .submit-button {
        background-color: #007bff;
        color: white;
      }

      .submit-button:hover {
        background-color: #0056b3;
      }

      .download-button {
        background-color: #28a745;
        color: white;
      }

      .download-button:hover {
        background-color: #218838;
      }

      .modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0,0,0,0.5);
      }

      .modal-content {
        background-color: #fefefe;
        margin: 15% auto;
        padding: 20px;
        border: 1px solid #888;
        width: 80%;
        max-width: 500px;
        border-radius: 5px;
        text-align: center;
        animation: modalFadeIn 0.3s ease;
      }

      @keyframes modalFadeIn {
        from {opacity: 0; transform: translateY(-20px);}
        to {opacity: 1; transform: translateY(0);}
      }
    </style>
  </head>
  <body>
    <div class="container">
      <hr class="top_hr" />
      <div class="image-container">
        <br>
        <br>
        <img
          src="https://wasmerco.com/wp-content/uploads/2022/09/Logo-White-Tagline.png"
          alt="Valve for measuring CFM"
          style="height: 50px; width: 200px; border: none"
        />
      </div>
      
      <!-- Tab navigation -->
      <div class="tabs">
        <button class="tablinks active" onclick="openTab(event, 'PAI')">Compressed Air PAI</button>
        <button class="tablinks" onclick="openTab(event, 'DataLogging')">Remove Data Logging</button>
        <button class="tablinks" onclick="openTab(event, 'StudyReport')">Study Report</button>
        <button class="tablinks" onclick="openTab(event, 'Presentation')">Presentation</button>
      </div>
      
      <!-- PAI Incentive Form -->
      <div id="PAI" class="tabcontent" style="display:block;">
        <form id="mainForm">
          <h2>020A - Compressed Air PAI Incentive Procedure</h2>
          <div class="form-group">
            <label
              >Preliminary assessment completed
              <span class="required">*</span></label
            >
            <div class="button-group">
              <button type="button" name="prelim_assess" value="yes">Yes</button>
              <button type="button" name="prelim_assess" value="no">No</button>
              <button type="button" name="prelim_assess" value="na">N/A</button>
            </div>
          </div>
          <div class="form-group">
            <label style="margin-bottom: 0"
              ><input type="checkbox" name="pai_shared" />
              PAI shared with Tim to create sales order
              <span class="required">*</span></label
            >
          </div>
          <div class="form-group">
            <label for="report_presentation_date"
              >Expected date for report presentation</label
            >
            <input
              type="date"
              id="report_presentation_date"
              name="report_presentation_date"
              required
            />
          </div>
          <div class="form-group">
            <label for="operating_hours"
              >Operating hours of the plant <span class="required">*</span></label
            >
            <input
              type="number"
              id="operating_hours"
              name="operating_hours"
              placeholder="Number will be entered here"
            />
          </div>
          <div class="form-group">
            <label for="data_walkthrough"
              >Data gathered from nameplates and initial walkthrough
              <span class="required">*</span></label
            >
            <textarea
              id="data_walkthrough"
              name="data_walkthrough"
              placeholder="Text will be entered here"
              required
            ></textarea>
          </div>
          <div class="form-group">
            <label for="compressor_data">
              Number of compressors and their data <span class="required">*</span
              ><br />
              <small
                >Include their serial &amp; model number if possible (otherwise
                HP, CFM &amp; location)</small
              >
            </label>
            <textarea
              id="compressor_data"
              name="compressor_data"
              placeholder="Text will be entered here"
            ></textarea>
          </div>
          <div class="form-group">
            <label for="dryer_setpoint"
              >Setpoint of all dryers <span class="required">*</span></label
            >
            <textarea
              id="dryer_setpoint"
              name="dryer_setpoint"
              placeholder="Text will be entered here"
            ></textarea>
          </div>
          <div class="form-group">
            <label for="air_dryers_data">
              Number of air dryers <span class="required">*</span><br />
              <small
                >Include serial &amp; model number if possible (otherwise HP, CFM
                &amp; location)</small
              >
            </label>
            <textarea
              id="air_dryers_data"
              name="air_dryers_data"
              placeholder="Text will be entered here"
            ></textarea>
          </div>
          <div class="form-group">
            <label for="dryer_dew_point"
              >Dew point setpoint of all dryers
              <span class="required">*</span></label
            >
            <textarea
              id="dryer_dew_point"
              name="dryer_dew_point"
              placeholder="Text will be entered here"
            ></textarea>
          </div>

          <div class="form-group">
            <label style="margin-bottom: 0"
              ><input
                type="checkbox"
                id="setpoint_pressure"
                name="setpoint_pressure"
              />
              Setpoint Pressure <span class="required">*</span></label
            >
          </div>
          <div class="form-group">
            <label for="setpoint_pressure_value"
              >Enter the value <span class="required">*</span></label
            >
            <textarea
              id="setpoint_pressure_value"
              name="setpoint_pressure_value"
              placeholder="Text will be entered here"
            ></textarea>
          </div>
          <div class="form-group">
            <label
              >Do the compressors have VFDs <span class="required">*</span></label
            >
            <div class="button-group">
              <button type="button" name="compressors_vfds" value="yes">
                Yes
              </button>
              <button type="button" name="compressors_vfds" value="no">No</button>
              <button type="button" name="compressors_vfds" value="na">
                N/A
              </button>
            </div>
          </div>
          <div class="form-group">
            <label for="vfds_controlled"
              >How are they controlled? <span class="required">*</span></label
            >
            <textarea
              id="vfds_controlled"
              name="vfds_controlled"
              placeholder="Text will be entered here"
            ></textarea>
          </div>
          <div class="form-group">
            <label
              >Charters for the No-brainer solutions completed
              <span class="required">*</span></label
            >
            <div class="button-group">
              <button type="button" name="charters_completed" value="yes">
                Yes
              </button>
              <button type="button" name="charters_completed" value="no">
                No
              </button>
              <button type="button" name="charters_completed" value="na">
                N/A
              </button>
            </div>
          </div>
          <div class="form-group">
            <label
              >Do they have storage tanks? (dry tanks vs wet tanks)
              <span class="required">*</span></label
            >
            <div class="button-group">
              <button type="button" name="storage_tanks" value="yes">Yes</button>
              <button type="button" name="storage_tanks" value="no">No</button>
              <button type="button" name="storage_tanks" value="na">N/A</button>
            </div>
          </div>

          <div class="form-group">
            <label for="storage_details"
              >What is the total Storage Dry VS Wet &amp; locations
              <span class="required">*</span></label
            >
            <textarea
              id="storage_details"
              name="storage_details"
              placeholder="Text will be entered here"
            ></textarea>
          </div>
          <div class="form-group">
            <label
              >Heat recovery from the compressor exhaust possible
              <span class="required">*</span></label
            >
            <div class="button-group">
              <button type="button" name="heat_recovery" value="yes">Yes</button>
              <button type="button" name="heat_recovery" value="no">No</button>
              <button type="button" name="heat_recovery" value="na">N/A</button>
            </div>
          </div>
          <div class="form-group">
            <label for="pipe_sizes"
              >Pipe sizes for the main headers
              <span class="required">*</span></label
            >
            <textarea
              id="pipe_sizes"
              name="pipe_sizes"
              placeholder="Text will be entered here"
            ></textarea>
          </div>
          <div class="form-group">
            <label for="min_pressure_equipment"
              >Minimum pressure required for the equipment
              <span class="required">*</span></label
            >
            <textarea
              id="min_pressure_equipment"
              name="min_pressure_equipment"
              placeholder="Text will be entered here"
            ></textarea>
          </div>
          <div class="form-group">
            <label for="pressure_farthest_point"
              >Compressed air pressure at the farthest point of the line (if
              possible)</label
            >
            <textarea
              id="pressure_farthest_point"
              name="pressure_farthest_point"
              placeholder="Text will be entered here"
            ></textarea>
          </div>
          <div class="form-group">
            <label for="distance_farthest_point"
              >Estimate how far the farthest point of line (ft)
              <span class="required">*</span></label
            >
            <input
              type="number"
              id="distance_farthest_point"
              name="distance_farthest_point"
              placeholder="Number will be entered here"
            />
          </div>
          <div class="form-group">
            <label for="drains_type"
              >Type of drains (Manual, Timer or No-air-loss) and count</label
            >
            <textarea
              id="drains_type"
              name="drains_type"
              placeholder="Text will be entered here"
            ></textarea>
          </div>
          <div class="form-group">
            <label for="low_pressure_filters"
              >Do they have low pressure-drop filters?
              <span class="required">*</span></label
            >
            <textarea
              id="low_pressure_filters"
              name="low_pressure_filters"
              placeholder="Text will be entered here"
            ></textarea>
          </div>

          <div class="form-group">
            <label
              >Compressed air baseload identified
              <span class="required">*</span></label
            >
            <div class="button-group">
              <button type="button" name="baseload_identified" value="yes">
                Yes
              </button>
              <button type="button" name="baseload_identified" value="no">
                No
              </button>
              <button type="button" name="baseload_identified" value="na">
                N/A
              </button>
            </div>
          </div>
          <div class="form-group">
            <label>Machine ID & flow for machines needing air continuously</label>
            <div class="button-group">
              <button type="button" name="machine_flow" value="yes">Yes</button>
              <button type="button" name="machine_flow" value="no">No</button>
              <button type="button" name="machine_flow" value="na">N/A</button>
            </div>
          </div>
          <div class="form-group">
            <label
              >Compressed air inappropriate use audit completed
              <span class="required">*</span></label
            >
            <div class="button-group">
              <button type="button" name="inappropriate_audit" value="pass">
                Pass
              </button>
              <button type="button" name="inappropriate_audit" value="flag">
                Flag
              </button>
              <button type="button" name="inappropriate_audit" value="fail">
                Fail
              </button>
            </div>
          </div>
          <div class="form-group">
            <label
              >Any compressed air restrictions <span class="required">*</span
              ><br /><small>Such as 90 degrees elbows</small></label
            >
            <div class="button-group">
              <button type="button" name="air_restrictions" value="pass">
                Pass
              </button>
              <button type="button" name="air_restrictions" value="flag">
                Flag
              </button>
              <button type="button" name="air_restrictions" value="fail">
                Fail
              </button>
            </div>
          </div>
          <div class="form-group">
            <label for="restriction_locations"
              >Enter their locations <span class="required">*</span></label
            >
            <textarea
              id="restriction_locations"
              name="restriction_locations"
              placeholder="Text will be entered here"
            ></textarea>
          </div>
          <div class="form-group">
            <label for="attach_pictures">
              Attach pictures <span class="required">*</span>
            </label>

            <!-- Upload Box (Will be hidden after upload) -->
            <div class="custom-upload-box" id="customUploadBox">
              Assignees will add a Picture/File here
            </div>

            <!-- Hidden file input -->
            <input
              type="file"
              id="attach_pictures"
              name="attach_pictures"
              accept="image/*"
              multiple
              required
            />

            <!-- Preview area, initially hidden -->
            <div id="attach_pictures_preview" class="image-preview hidden"></div>
          </div>

          <div class="form-group">
            <label>Number of blow off gun <span class="required">*</span></label>
            <div class="button-group">
              <button type="button" name="blow_off_gun" value="yes">Yes</button>
              <button type="button" name="blow_off_gun" value="no">No</button>
              <button type="button" name="blow_off_gun" value="na">N/A</button>
            </div>
          </div>
          <div class="form-group">
            <label for="pneumatic_guns_quantity"
              >Quantity of pneumatic guns (Ask the plant personal if possible)
              <span class="required">*</span></label
            >
            <input
              type="number"
              id="pneumatic_guns_quantity"
              name="pneumatic_guns_quantity"
              placeholder="Number will be entered here"
            />
          </div>

          <div class="form-group">
            <label for="scadar_installation_date"
              >Expected date for SCADAR installation</label
            >
            <input
              type="date"
              id="scadar_installation_date"
              name="scadar_installation_date"
            />
          </div>
          <div class="form-group">
            <label for="potential_savings"
              >Potential savings ideas and comments
              <span class="required">*</span></label
            >
            <textarea
              id="potential_savings"
              name="potential_savings"
              placeholder="Text will be entered here"
            ></textarea>
          </div>

          <h2>Measuring the CFM</h2>
          <div class="form-group">
            <label>
              Do they have a 1/2 valve after the air compressor and before it
              starts branching out for demand, with at least 20 times the diameter
              of straight piping? This setup would allow us to measure the CFM
              accurately.<br />
              <span class="required">*</span>
            </label>
            <div class="image-container">
              <img
                src="https://cdn.photographylife.com/wp-content/uploads/2014/06/Nikon-D810-Image-Sample-6.jpg"
                alt="Valve for measuring CFM"
                style="height: 300px; width: 300px"
              />
            </div>
            <div class="button-group">
              <button type="button" name="cfm_valve" value="yes">Yes</button>
              <button type="button" name="cfm_valve" value="no">No</button>
              <button type="button" name="cfm_valve" value="na">N/A</button>
            </div>
          </div>
          <div class="form-group">
            <label
              >The valve needs to be installed; check with client if they want:
              <span class="required">*</span></label
            >
            <div
              class="radio-group"
              style="flex-direction: column; gap: 1px; margin-top: 10px"
            >
              <label style="margin-bottom: 2px"
                ><input type="radio" name="install_option" value="wasmer" />
                Wasmer team to install it and charge the client, the price could
                range in between $1100 to $1500</label
              >
              <label style="margin-bottom: 0"
                ><input
                  type="radio"
                  name="install_option"
                  value="wasmer"
                  required
                />
                Their maintenance team to install it</label
              >
            </div>
          </div>

          <h2>Completion of Work Order</h2>
          <div class="form-group">
            <label for="task_completion">
              Task Completion and Delay Reporting <span class="required">*</span
              ><br />
              <small
                >Please indicate whether you completed the tasks by the expected
                deadline. If you experienced any delays, kindly provide the
                specific reasons.</small
              >
            </label>
            <textarea
              id="task_completion"
              name="task_completion"
              placeholder="Text will be entered here"
            ></textarea>
          </div>
          <div class="form-group">
            <label for="sign_off">Sign Off <span class="required">*</span></label>
            <canvas id="signature-pad" class="sign_canvas" style="width: 100%; height: 110px;"></canvas>
          </div>
        </form>
        
        <div class="tab-navigation">
          <button onclick="openTab(event, 'DataLogging')">Next</button>
        </div>
      </div>
      
      <!-- Data Logging Equipment Removal -->
      <div id="DataLogging" class="tabcontent">
        <form id="dataLoggingForm">
          <h2>Compressed Air Remove Data Logging Equipment</h2>
          
          <div class="form-group">
            <label>Pre-Removal Preparation</label>
            <div class="form-group">
              <label for="personnel_notified">The Relevant Personnel Notified <span class="required">*</span></label>
              <div class="button-group">
                <button type="button" name="personnel_notified" value="yes">Yes</button>
                <button type="button" name="personnel_notified" value="no">No</button>
                <button type="button" name="personnel_notified" value="na">N/A</button>
              </div>
              <small>Double check that with the customer</small>
            </div>
          </div>
          
          <div class="form-group">
            <label>Equipment and Tool Check</label>
            <div class="form-group">
              <label>Suggested list tool</label>
              <div class="checkbox-group">
                <label><input type="checkbox" name="tool_screwdrivers">Screwdrivers</label>
                <label><input type="checkbox" name="tool_pliers">Pliers</label>
                <label><input type="checkbox" name="tool_wrench">Adjustable Wrench or Socket Set</label>
                <label><input type="checkbox" name="tool_flashlight">Flashlight or Headlamp</label>
                <label><input type="checkbox" name="tool_fittings">Different fitting sizes to connect the Pressure data logger</label>
                <label><input type="checkbox" name="tool_tape">Teflon tape</label>
                <label><input type="checkbox" name="tool_containers">Containers or bags for storing removed equipment</label>
                <label><input type="checkbox" name="tool_labels">Labels or markers for identifying components</label>
                <label><input type="checkbox" name="tool_safety">Safety equipment (gloves, safety glasses)</label>
              </div>
            </div>
          </div>

          <div class="form-group">
            <label>Equipment Removal Process</label>
            <div class="form-group">
              <label for="removal_date">Date of Equipment Removal <span class="required">*</span></label>
              <input type="date" id="removal_date" name="removal_date" required />
            </div>

            <div class="form-group">
              <label for="equipment_removed">List of Equipment Removed <span class="required">*</span></label>
              <textarea id="equipment_removed" name="equipment_removed" placeholder="List all equipment that was removed" required></textarea>
            </div>

            <div class="form-group">
              <label for="removal_notes">Notes on Removal Process <span class="required">*</span></label>
              <textarea id="removal_notes" name="removal_notes" placeholder="Document any issues, observations, or special handling required during removal" required></textarea>
            </div>
          </div>

          <div class="form-group">
            <label>Post-Removal Verification</label>
            <div class="form-group">
              <label>System Integrity Check <span class="required">*</span></label>
              <div class="button-group">
                <button type="button" name="system_integrity" value="pass">Pass</button>
                <button type="button" name="system_integrity" value="flag">Flag</button>
                <button type="button" name="system_integrity" value="fail">Fail</button>
              </div>
            </div>

            <div class="form-group">
              <label for="integrity_notes">System Integrity Notes</label>
              <textarea id="integrity_notes" name="integrity_notes" placeholder="Document any issues or concerns with system integrity after removal"></textarea>
            </div>
          </div>

          <div class="form-group">
            <label for="attach_removal_pictures">Attach Pictures of Removal Process <span class="required">*</span></label>
            <!-- Upload Box (Will be hidden after upload) -->
            <div class="custom-upload-box" id="customUploadBoxRemoval">
              Assignees will add Pictures/Files here
            </div>

            <!-- Hidden file input -->
            <input
              type="file"
              id="attach_removal_pictures"
              name="attach_removal_pictures"
              accept="image/*"
              multiple
              required
            />

            <!-- Preview area, initially hidden -->
            <div id="attach_removal_pictures_preview" class="image-preview hidden"></div>
          </div>

          <div class="form-group">
            <label for="customer_acknowledgment">Customer Acknowledgment <span class="required">*</span></label>
            <div class="checkbox-group">
              <label><input type="checkbox" name="customer_acknowledged" required> Customer has acknowledged the removal of equipment</label>
              <label><input type="checkbox" name="equipment_returned" required> All removed equipment has been properly stored/returned</label>
            </div>
          </div>

          <div class="form-group">
            <label for="removal_completion">Completion Notes <span class="required">*</span></label>
            <textarea id="removal_completion" name="removal_completion" placeholder="Any additional notes or observations about the removal process" required></textarea>
          </div>

          <div class="form-group">
            <label for="sign_off_removal">Sign Off <span class="required">*</span></label>
            <canvas id="signature-pad-removal" class="sign_canvas" style="width: 100%; height: 110px;"></canvas>
          </div>
        </form>

        <div class="tab-navigation">
          <button onclick="openTab(event, 'PAI')">Previous</button>
          <button onclick="openTab(event, 'StudyReport')">Next</button>
        </div>
      </div>

      <!-- Study Report Tab -->
      <div id="StudyReport" class="tabcontent">
        <form id="studyReportForm">
          <h2>Compressed Air Study Report</h2>
          
          <div class="form-group">
            <label>Report Information</label>
            <div class="form-group">
              <label for="report_id">Report ID <span class="required">*</span></label>
              <input type="text" id="report_id" name="report_id" value="#2054555" readonly />
            </div>
            <div class="form-group">
              <label for="company_name">Company <span class="required">*</span></label>
              <input type="text" id="company_name" name="company_name" value="Wasmer Company" readonly />
            </div>
            <div class="form-group">
              <label for="exported_by">Exported By <span class="required">*</span></label>
              <input type="text" id="exported_by" name="exported_by" value="Govind Bamotriya" readonly />
            </div>
            <div class="form-group">
              <label for="report_date">Date <span class="required">*</span></label>
              <input type="date" id="report_date" name="report_date" value="2025-05-13" required />
            </div>
          </div>

          <div class="form-group">
            <label>Summary Table <span class="required">*</span></label>
            <div class="checkbox-group">
              <label><input type="checkbox" name="summary_potential_savings" required> Potential Saving Ideas</label>
              <label><input type="checkbox" name="summary_energy_savings" required> Energy Savings</label>
              <label><input type="checkbox" name="summary_cost_savings" required> Cost Savings (% Reduction)</label>
              <label><input type="checkbox" name="summary_implementation_cost" required> Implementation Cost</label>
              <label><input type="checkbox" name="summary_incentives" required> Incentives</label>
              <label><input type="checkbox" name="summary_payback" required> Payback Period</label>
            </div>
          </div>

          <div class="form-group">
            <label for="project_background">Project Background <span class="required">*</span></label>
            <textarea id="project_background" name="project_background" placeholder="Provide a detailed description for the compressed air system including equipment pressure requirements and equipment summary" required></textarea>
          </div>

          <div class="form-group">
            <label for="discoveries_challenges">Discoveries & Challenges <span class="required">*</span></label>
            <textarea id="discoveries_challenges" name="discoveries_challenges" placeholder="Describe all the discoveries and challenges that the engineering team has encountered" required></textarea>
          </div>

          <div class="form-group">
            <label>Graphs Required <span class="required">*</span></label>
            <div class="checkbox-group">
              <label><input type="checkbox" name="graph_supply_flow" required> Supply Flow</label>
              <label><input type="checkbox" name="graph_flow_per_compressor" required> Flow per Air Compressor</label>
              <label><input type="checkbox" name="graph_flow_pressure_status" required> Flow, Pressure, and Status</label>
              <label><input type="checkbox" name="graph_demand_supply" required> Demand vs. Supply Flow</label>
              <label><input type="checkbox" name="graph_electrical_variables" required> Electrical Variables per Air Compressor</label>
              <label><input type="checkbox" name="graph_system_layout" required> System Layout</label>
              <label><input type="checkbox" name="graph_dryer" required> Dryer Graphs</label>
            </div>
            <small>Note: All graphs need to be added to the report</small>
          </div>

          <div class="form-group">
            <label>Data Requirements <span class="required">*</span></label>
            <div class="checkbox-group">
              <label><input type="checkbox" name="data_cfm" required> CFM during production and non-production hours</label>
              <label><input type="checkbox" name="data_pressure_variation" required> Pressure variation (swing)</label>
              <label><input type="checkbox" name="data_max_pressure" required> Max Pressure</label>
              <label><input type="checkbox" name="data_min_pressure" required> Minimum Pressure</label>
              <label><input type="checkbox" name="data_setpoint_pressure" required> Setpoint Pressure</label>
              <label><input type="checkbox" name="data_avg_pressure" required> Average Pressure</label>
              <label><input type="checkbox" name="data_demand_supply_variance" required> Variance between demand and supply</label>
            </div>
          </div>

          <div class="form-group">
            <label>Analysis <span class="required">*</span></label>
            <div class="checkbox-group">
              <label><input type="checkbox" name="analysis_electrical" required> Electrical Analysis</label>
              <label><input type="checkbox" name="analysis_hardware" required> System Hardware Analysis</label>
              <label><input type="checkbox" name="analysis_storage" required> Storage Gallons/CFM</label>
              <label><input type="checkbox" name="analysis_kpi" required> System KPI kW/CFM</label>
              <label><input type="checkbox" name="analysis_operating_cost" required> Annual Operating Cost</label>
              <label><input type="checkbox" name="analysis_dryers" required> Dryers Analysis</label>
              <label><input type="checkbox" name="analysis_nitrogen" required> Nitrogen Generator Analysis</label>
            </div>
          </div>

          <div class="form-group">
            <label for="potential_solutions">Potential Solutions <span class="required">*</span></label>
            <textarea id="potential_solutions" name="potential_solutions" placeholder="Describe the potential solutions with energy savings, cost savings, implementation cost, incentives, and payback" required></textarea>
          </div>

          <div class="form-group">
            <label for="report_review">Report Reviewing <span class="required">*</span></label>
            <div class="button-group">
              <button type="button" name="review_status" value="pending">Pending Review</button>
              <button type="button" name="review_status" value="in_progress">In Review</button>
              <button type="button" name="review_status" value="completed">Review Completed</button>
            </div>
          </div>

          <div class="form-group">
            <label for="attach_final_report">Attach Final Report <span class="required">*</span></label>
            <div class="custom-upload-box" id="customUploadBoxReport">
              Assignees will add the final report here
            </div>
            <input type="file" id="attach_final_report" name="attach_final_report" accept=".pdf,.doc,.docx" required />
            <div id="attach_final_report_preview" class="image-preview hidden"></div>
          </div>

          <div class="form-group">
            <label for="task_completion_report">Task Completion and Delay Reporting <span class="required">*</span></label>
            <textarea id="task_completion_report" name="task_completion_report" placeholder="Please indicate whether you completed the tasks by the expected deadline. If you experienced any delays, kindly provide the specific reasons" required></textarea>
          </div>

          <div class="form-group">
            <label for="sign_off_report">Sign Off <span class="required">*</span></label>
            <canvas id="signature-pad-report" class="sign_canvas" style="width: 100%; height: 110px;"></canvas>
          </div>
        </form>

        <div class="tab-navigation">
          <button onclick="openTab(event, 'DataLogging')">Previous</button>
          <button onclick="openTab(event, 'Presentation')">Next</button>
        </div>
      </div>

      <!-- Presentation Tab -->
      <div id="Presentation" class="tabcontent">
        <form id="presentationForm">
          <h2>Compressed Air Presentation</h2>
          
          <div class="form-group">
            <label>Presentation Information</label>
            <div class="form-group">
              <label for="presentation_id">Report ID <span class="required">*</span></label>
              <input type="text" id="presentation_id" name="presentation_id" value="#2040367" readonly />
            </div>
            <div class="form-group">
              <label for="presentation_company">Company <span class="required">*</span></label>
              <input type="text" id="presentation_company" name="presentation_company" value="Wasmer Company" readonly />
            </div>
            <div class="form-group">
              <label for="presentation_exported_by">Exported By <span class="required">*</span></label>
              <input type="text" id="presentation_exported_by" name="presentation_exported_by" value="Govind Bamotriya" readonly />
            </div>
            <div class="form-group">
              <label for="presentation_date">Date <span class="required">*</span></label>
              <input type="date" id="presentation_date" name="presentation_date" value="2025-05-13" required />
            </div>
          </div>

          <div class="form-group">
            <label for="scadar_report">Final SCADAR Report <span class="required">*</span></label>
            <div class="button-group">
              <button type="button" name="scadar_status" value="pending">Pending</button>
              <button type="button" name="scadar_status" value="in_progress">In Progress</button>
              <button type="button" name="scadar_status" value="completed">Completed</button>
            </div>
            <textarea id="scadar_report" name="scadar_report" placeholder="Ensure the SCADAR report is finalized and documented properly" required></textarea>
          </div>

          <div class="form-group">
            <label for="client_communication">Client Communication <span class="required">*</span></label>
            <div class="button-group">
              <button type="button" name="communication_status" value="pending">Not Shared</button>
              <button type="button" name="communication_status" value="shared">Shared</button>
              <button type="button" name="communication_status" value="acknowledged">Acknowledged</button>
            </div>
            <textarea id="client_communication" name="client_communication" placeholder="Share the report with the client" required></textarea>
          </div>

          <div class="form-group">
            <label for="energy_wallet">Energy Wallet Update <span class="required">*</span></label>
            <div class="button-group">
              <button type="button" name="wallet_status" value="pending">Pending Update</button>
              <button type="button" name="wallet_status" value="in_progress">Updating</button>
              <button type="button" name="wallet_status" value="completed">Updated</button>
            </div>
            <textarea id="energy_wallet" name="energy_wallet" placeholder="Update the Energy Wallet with the report data and relevant findings" required></textarea>
          </div>

          <div class="form-group">
            <label for="task_completion_presentation">Task Completion and Delay Reporting <span class="required">*</span></label>
            <textarea id="task_completion_presentation" name="task_completion_presentation" placeholder="Please indicate whether you completed the tasks by the expected deadline. If any delays occurred, provide the specific reasons" required></textarea>
          </div>

          <div class="form-group">
            <label for="sign_off_presentation">Sign Off <span class="required">*</span></label>
            <canvas id="signature-pad-presentation" class="sign_canvas" style="width: 100%; height: 110px;"></canvas>
          </div>
        </form>

        <div class="tab-navigation">
          <button onclick="openTab(event, 'StudyReport')">Previous</button>
        </div>
      </div>
    </div>

    <!-- Add buttons container at the bottom -->
    <div class="container" style="margin-top: 20px; text-align: center;">
      <div class="form-group" style="border: none; padding: 0;">
        <button type="button" id="submitAllForms" class="submit-button">Submit All Forms</button>
        <button type="button" id="downloadPDF" class="download-button">Download as PDF</button>
      </div>
    </div>

    <!-- Add modal for submission confirmation -->
    <div id="submissionModal" class="modal" style="display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5);">
      <div class="modal-content" style="background-color: #fefefe; margin: 15% auto; padding: 20px; border: 1px solid #888; width: 80%; max-width: 500px; border-radius: 5px; text-align: center;">
        <h2 style="color: #007bff;">Form Submitted Successfully!</h2>
        <p>All forms have been submitted successfully.</p>
        <button onclick="closeModal()" style="background-color: #007bff; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; margin-top: 20px;">Close</button>
      </div>
    </div>

    <script>
      function openTab(evt, tabName) {
        var i, tabcontent, tablinks;
        tabcontent = document.getElementsByClassName("tabcontent");
        for (i = 0; i < tabcontent.length; i++) {
          tabcontent[i].style.display = "none";
        }
        tablinks = document.getElementsByClassName("tablinks");
        for (i = 0; i < tablinks.length; i++) {
          tablinks[i].className = tablinks[i].className.replace(" active", "");
        }
        document.getElementById(tabName).style.display = "block";
        evt.currentTarget.className += " active";
      }

      // Initialize signature pads
      document.addEventListener('DOMContentLoaded', function() {
        // Initialize signature pad for PAI form
        var canvas = document.getElementById('signature-pad');
        var signaturePad = new SignaturePad(canvas, {
          backgroundColor: 'rgb(255, 255, 255)'
        });

        // Initialize signature pad for Data Logging form
        var canvasRemoval = document.getElementById('signature-pad-removal');
        var signaturePadRemoval = new SignaturePad(canvasRemoval, {
          backgroundColor: 'rgb(255, 255, 255)'
        });

        // Handle file uploads and previews
        function setupFileUpload(inputId, previewId, uploadBoxId) {
          const input = document.getElementById(inputId);
          const preview = document.getElementById(previewId);
          const uploadBox = document.getElementById(uploadBoxId);

          input.addEventListener('change', function(e) {
            preview.innerHTML = '';
            preview.classList.remove('hidden');
            uploadBox.style.display = 'none';

            Array.from(e.target.files).forEach(file => {
              const reader = new FileReader();
              reader.onload = function(e) {
                const img = document.createElement('img');
                img.src = e.target.result;
                preview.appendChild(img);
              }
              reader.readAsDataURL(file);
            });
          });
        }

        setupFileUpload('attach_pictures', 'attach_pictures_preview', 'customUploadBox');
        setupFileUpload('attach_removal_pictures', 'attach_removal_pictures_preview', 'customUploadBoxRemoval');

        // Handle button groups
        document.querySelectorAll('.button-group').forEach(group => {
          group.querySelectorAll('button').forEach(button => {
            button.addEventListener('click', function() {
              // Remove active class from all buttons in the group
              group.querySelectorAll('button').forEach(btn => {
                btn.classList.remove('active');
              });
              // Add active class to clicked button
              this.classList.add('active');
            });
          });
        });

        // Initialize signature pad for Study Report form
        var canvasReport = document.getElementById('signature-pad-report');
        var signaturePadReport = new SignaturePad(canvasReport, {
          backgroundColor: 'rgb(255, 255, 255)'
        });

        // Initialize signature pad for Presentation form
        var canvasPresentation = document.getElementById('signature-pad-presentation');
        var signaturePadPresentation = new SignaturePad(canvasPresentation, {
          backgroundColor: 'rgb(255, 255, 255)'
        });

        // Setup file upload for final report
        setupFileUpload('attach_final_report', 'attach_final_report_preview', 'customUploadBoxReport');
      });

      // Add form submission and PDF download functionality
      document.addEventListener('DOMContentLoaded', function() {
        // ... existing initialization code ...

        // Handle form submission
        document.getElementById('submitAllForms').addEventListener('click', function() {
          // Clear all form inputs
          const forms = document.querySelectorAll('form');
          forms.forEach(form => {
            form.reset();
            // Clear signature pads
            const signaturePads = form.querySelectorAll('.sign_canvas');
            signaturePads.forEach(canvas => {
              const pad = SignaturePad.getInstance(canvas);
              if (pad) pad.clear();
            });
            // Clear file previews
            const previews = form.querySelectorAll('.image-preview');
            previews.forEach(preview => {
              preview.innerHTML = '';
              preview.classList.add('hidden');
            });
            // Show upload boxes
            const uploadBoxes = form.querySelectorAll('.custom-upload-box');
            uploadBoxes.forEach(box => {
              box.style.display = 'block';
            });
            // Reset button groups
            const buttonGroups = form.querySelectorAll('.button-group');
            buttonGroups.forEach(group => {
              group.querySelectorAll('button').forEach(btn => {
                btn.classList.remove('active');
              });
            });
          });

          // Show submission modal
          document.getElementById('submissionModal').style.display = 'block';
        });

        // Handle PDF download
        document.getElementById('downloadPDF').addEventListener('click', function() {
          const element = document.querySelector('.container');
          const opt = {
            margin: 1,
            filename: 'compressed_air_assessment.pdf',
            image: { type: 'jpeg', quality: 0.98 },
            html2canvas: { scale: 2 },
            jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' }
          };

          // Hide buttons before generating PDF
          const buttons = document.querySelectorAll('.submit-button, .download-button');
          buttons.forEach(button => button.style.display = 'none');

          // Generate PDF
          html2pdf().set(opt).from(element).save().then(() => {
            // Show buttons again after PDF is generated
            buttons.forEach(button => button.style.display = 'inline-block');
          });
        });
      });

      // Function to close modal
      function closeModal() {
        document.getElementById('submissionModal').style.display = 'none';
      }

      // Close modal when clicking outside
      window.onclick = function(event) {
        const modal = document.getElementById('submissionModal');
        if (event.target == modal) {
          modal.style.display = 'none';
        }
      }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/signature_pad@4.0.0/dist/signature_pad.umd.min.js"></script>
  </body>
</html>